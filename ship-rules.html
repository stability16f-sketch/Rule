<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KR STABILITY</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            background: linear-gradient(to bottom, #1e3a8a 0%, #3b82f6 50%, #0ea5e9 100%);
            position: relative;
            overflow-x: hidden;
        }

        /* Î∞îÎã§ Ïï†ÎãàÎ©îÏù¥ÏÖò */
        .ocean {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom,
                rgba(30, 58, 138, 0.3) 0%,
                rgba(59, 130, 246, 0.5) 50%,
                rgba(14, 165, 233, 0.7) 100%);
            z-index: 0;
        }

        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 150px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120"><path d="M0,50 Q300,0 600,50 T1200,50 L1200,120 L0,120 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: 600px 120px;
            animation: wave 15s linear infinite;
        }

        .wave:nth-child(2) {
            bottom: 20px;
            opacity: 0.5;
            animation: wave 10s linear infinite reverse;
        }

        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-600px); }
        }

        /* ÏÑ†Î∞ï Ïï†ÎãàÎ©îÏù¥ÏÖò */
        .ship {
            position: fixed;
            bottom: 180px;
            right: -200px;
            font-size: 60px;
            animation: sail 30s linear infinite;
            z-index: 1;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3));
        }

        @keyframes sail {
            0% { right: -200px; }
            100% { right: 100%; }
        }

        .container {
            position: relative;
            z-index: 10;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8fafc;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .checkbox-item:hover {
            background: #e0f2fe;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            cursor: pointer;
            accent-color: #3b82f6;
        }

        .checkbox-item label {
            cursor: pointer;
            margin: 0;
            font-size: 14px;
            color: #334155;
        }

        .search-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .search-btn:active {
            transform: translateY(0);
        }

        .pdf-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 15px;
            display: none;
        }

        .pdf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
        }

        .pdf-btn:active {
            transform: translateY(0);
        }

        .pdf-btn.show {
            display: block;
        }

        .result {
            background: #f0f9ff;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            display: none;
        }

        .result.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result h3 {
            color: #1e40af;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 1024px) {
            .result-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .result-grid {
                grid-template-columns: 1fr;
            }
        }

        /* PDF Ïù∏ÏáÑ Ïä§ÌÉÄÏùº */
        @media print {
            body {
                background: white;
            }

            .ocean, .ship, .header, .card form, .pdf-btn {
                display: none !important;
            }

            .container {
                max-width: 100%;
                padding: 0;
            }

            .card {
                background: white;
                box-shadow: none;
                padding: 20px;
            }

            .result {
                display: block !important;
                background: white;
                border: none;
                padding: 0;
                margin: 0;
            }

            .result h3 {
                color: #000;
                font-size: 24px;
                margin-bottom: 20px;
                page-break-after: avoid;
            }

            .result-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }

            .result-item {
                background: white;
                border: 1px solid #ddd;
                padding: 12px;
                page-break-inside: avoid;
            }

            .result-item h4 {
                color: #000;
                font-size: 14px;
                margin-bottom: 6px;
            }

            .result-item p {
                color: #333;
                font-size: 12px;
                line-height: 1.5;
            }

            .badge {
                background: #eee;
                color: #333;
                border: 1px solid #ccc;
            }
        }

        .result-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .result-item h4 {
            color: #1e3a8a;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .result-item p {
            color: #4b5563;
            line-height: 1.6;
            font-size: 14px;
        }

        .badge {
            display: inline-block;
            background: #3b82f6;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        /* 2Ïª¨Îüº Ìèº Î†àÏù¥ÏïÑÏõÉ */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 10px;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* ÌÉ≠ Ïä§ÌÉÄÏùº */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e5e7eb;
        }

        .tab-btn {
            padding: 12px 30px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #64748b;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: -2px;
        }

        .tab-btn:hover {
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }

        .tab-btn.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="ocean">
        <div class="wave"></div>
        <div class="wave"></div>
    </div>
    <div class="ship">üö¢</div>

    <div class="container">
        <div class="header">
            <h1>‚öì KR STABILITY</h1>
            <p>ÏÑ†Î∞ïÏùò Ï¢ÖÎ•ò, Ìï≠Ìï¥Íµ¨Ïó≠, Í∏∏Ïù¥Î•º ÏûÖÎ†•ÌïòÏó¨ Ï†ÅÏö©ÎêòÎäî Í∑úÏπôÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî</p>
        </div>

        <div class="card">
            <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('rules')">üîç Í∑úÏπô Í≤ÄÏÉâ</button>
                <button class="tab-btn" onclick="switchTab('interpolation')">üìà Cubic Spline Í≥ÑÏÇ∞Í∏∞</button>
            </div>

            <!-- Í∑úÏπô Í≤ÄÏÉâ ÌÉ≠ -->
            <div id="rulesTab" class="tab-content active">
                <form id="shipForm">
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="nationality">Íµ≠Ï†Å</label>
                            <select id="nationality" required>
                                <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                <option value="korean">ÌïúÍµ≠Ï†Å (BBCHP)</option>
                                <option value="foreign">ÏàúÏàòÏô∏Íµ≠Ï†Å</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="shipType">ÏÑ†Î∞ïÏùò Ï¢ÖÎ•ò</label>
                            <select id="shipType" required>
                                <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                <option value="oilchemicaltanker">OIL/CHEMICAL TANKER</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="voyageArea">Ìï≠Ìï¥Íµ¨Ïó≠</label>
                            <select id="voyageArea" required>
                                <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                <option value="ocean">ÏõêÏñë (Ocean Going)</option>
                                <option value="greatcoastal">Í∑ºÌï¥ (Great Coastal)</option>
                                <option value="coastal">Ïó∞Ìï¥ (Coastal)</option>
                                <option value="freshwater">ÌèâÏàò (Fresh Water)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-col">
                        <div class="form-group">
                            <label for="length">ÏÑ†Î∞ï Í∏∏Ïù¥ (m)</label>
                            <input type="number" id="length" placeholder="Ïòà: 100" min="1" required>
                        </div>

                        <div class="form-group">
                            <label for="dwt">Ïû¨ÌôîÏ§ëÎüâ (DWT)</label>
                            <input type="number" id="dwt" placeholder="Ïòà: 50000" min="0">
                        </div>

                        <div class="form-group">
                            <label for="gt">ÌÜ§Ïàò (GT)</label>
                            <input type="number" id="gt" placeholder="Ïòà: 30000" min="0">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>ÏÑ†Í∏âÎ∂ÄÌò∏ (Class Notation)</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="ice" name="notation" value="ice">
                            <label for="ice">ICE (ÎåÄÎπôÎì±Í∏â)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="LI" name="notation" value="LI">
                            <label for="LI">LI (Î°úÎî©Ïª¥Ìì®ÌÑ∞)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sps" name="notation" value="sps">
                            <label for="sps">SPS (ÌäπÏàòÎ™©Ï†ÅÏÑ†ÏΩîÎìú)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="ip" name="notation" value="ip">
                            <label for="ip">IP (ÏÇ∞ÏóÖÏù∏Î†• Ïö¥ÏÜ°ÏÑ†Î∞ï ÏΩîÎìú)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sfv" name="notation" value="sfv">
                            <label for="sfv">SFV (ÌÜ†Î†àÎ™∞Î¶¨ÎÖ∏Ïä§)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="blu" name="notation" value="blu">
                            <label for="blu">BLU</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lngready" name="notation" value="lngready">
                            <label for="lngready">LNG Ready</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="ammoniaready" name="notation" value="ammoniaready">
                            <label for="ammoniaready">Ammonia Ready</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="methanolready" name="notation" value="methanolready">
                            <label for="methanolready">Methanol Ready</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="ethanolready" name="notation" value="ethanolready">
                            <label for="ethanolready">Ethanol Ready</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="ers" name="notation" value="ers">
                            <label for="ers">ERS</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="nbs" name="notation" value="nbs">
                            <label for="nbs">NBS</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="liqbc" name="notation" value="liqbc">
                            <label for="liqbc">LIQBC (1/2)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="csr" name="notation" value="csr">
                            <label for="csr">CSR</label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="search-btn">üîç Ï†ÅÏö© Í∑úÏπô Í≤ÄÏÉâ</button>
            </form>

            <div id="result" class="result">
                <h3>üìã Ï†ÅÏö©ÎêòÎäî Í∑úÏπô</h3>
                <div id="resultContent"></div>
            </div>

                <button id="pdfBtn" class="pdf-btn" onclick="downloadPDF()">
                    üñ®Ô∏è PDFÎ°ú Ï†ÄÏû• (Ïù∏ÏáÑ)
                </button>
            </div>

            <!-- Î≥¥Í∞Ñ Í≥ÑÏÇ∞Í∏∞ ÌÉ≠ -->
            <div id="interpolationTab" class="tab-content">
                <h2 style="color: #1e3a8a; margin-bottom: 20px; text-align: center;">üìà Cubic Spline Î≥¥Í∞Ñ Í≥ÑÏÇ∞Í∏∞</h2>

                <div class="form-group">
                    <label>X Í∞í (ÏâºÌëúÎ°ú Íµ¨Î∂Ñ)</label>
                    <input type="text" id="xValues" value="10, 20, 30, 40" placeholder="Ïòà: 10, 20, 30, 40">
                </div>

                <div class="form-group">
                    <label>Y Í∞í (ÏâºÌëúÎ°ú Íµ¨Î∂Ñ)</label>
                    <input type="text" id="yValues" value="5, 10, 18, 35" placeholder="Ïòà: 5, 10, 18, 35">
                </div>

                <div class="form-group">
                    <label>Î≥¥Í∞ÑÌï† X Í∞í</label>
                    <input type="number" id="interpolateX" value="21.5" step="0.1" placeholder="Ïòà: 21.5">
                </div>

                <button class="search-btn" onclick="calculateInterpolation()">üìä Î≥¥Í∞Ñ Í≥ÑÏÇ∞</button>

                <div id="interpolationResult" style="display: none; margin-top: 20px; padding: 15px; background: #f0f9ff; border-left: 4px solid #3b82f6; border-radius: 10px;">
                    <h3 style="color: #1e40af; margin-bottom: 10px;">Í≥ÑÏÇ∞ Í≤∞Í≥º</h3>
                    <p id="resultText" style="font-size: 18px; font-weight: 600; color: #1e3a8a;"></p>
                </div>

                <div style="margin-top: 30px;">
                    <canvas id="interpolationChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÌÉ≠ Ï†ÑÌôò Ìï®Ïàò
        function switchTab(tabName) {
            // Î™®Îì† ÌÉ≠ Î≤ÑÌäºÍ≥º Ïª®ÌÖêÏ∏†Ïùò active ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // ÏÑ†ÌÉùÎêú ÌÉ≠ ÌôúÏÑ±Ìôî
            if (tabName === 'rules') {
                document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
                document.getElementById('rulesTab').classList.add('active');
            } else if (tabName === 'interpolation') {
                document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
                document.getElementById('interpolationTab').classList.add('active');
            }
        }

        // ÏÑ†Î∞ï Í∑úÏπôÏùÑ Î∞òÌôòÌïòÎäî Ìï®Ïàò - {ÌòëÏïΩ, ÏÑ†Í∏â, ÏïàÏ†ÑÎ≤ï} Í∞ùÏ≤¥ Î∞òÌôò
        function getRules(nationality, shipType, voyageArea, length, gt, dwt) {
            const gtNum  = parseFloat(gt)  || 0;
            const dwtNum = parseFloat(dwt) || 0;
            const r = { ÌòëÏïΩ: [], ÏÑ†Í∏â: [], ÏïàÏ†ÑÎ≤ï: [] };

            // Íµ≠Ï†úÌï≠Ìï¥ Ïó¨Î∂Ä (ÏõêÏñë¬∑Í∑ºÌï¥)
            const isInternational = (voyageArea === 'ocean' || voyageArea === 'greatcoastal');

            if (shipType === 'oilchemicaltanker') {

                // ‚îÄ‚îÄ ÌòëÏïΩ (Íµ≠Ï†úÌï≠Ìï¥ Ïãú Ï†ÅÏö©) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                if (isInternational) {

                    // MARPOL Annex I¬∑II: 150 GT ÎòêÎäî 150 DWT Ïù¥ÏÉÅ ÌÉ±Ïª§
                    if (gtNum >= 150 || dwtNum >= 150) {
                        r.ÌòëÏïΩ.push('MARPOL Annex I, II');
                    }

                    // IBC Code: ÌôîÌïôÌÉ±Ïª§ ÌïÑÏàò
                    r.ÌòëÏïΩ.push('IBC Code');

                    // SOLAS¬∑ISM¬∑ISPS: GT Í∏∞Ï§ÄÏúºÎ°ú Ï†ÅÏö© Î≤îÏúÑ Í≤∞Ï†ï
                    if (gtNum >= 500 || length >= 100) {
                        // ÎåÄÌòï: SOLAS Ï†Ñ Ï±ïÌÑ∞ + ISM + ISPS
                        r.ÌòëÏïΩ.push('SOLAS Ï†ÑÏ≤¥', 'ISM Code', 'ISPS Code');
                    } else if (gtNum >= 300 || length >= 24) {
                        // Ï§ëÌòï: SOLAS Ï£ºÏöî Ï±ïÌÑ∞ + ISM
                        r.ÌòëÏïΩ.push('SOLAS Í∑úÏ†ï', 'ISM Code');
                    } else {
                        // ÏÜåÌòï: SOLAS ÏùºÎ∂Ä Ï±ïÌÑ∞
                        r.ÌòëÏïΩ.push('SOLAS ÏùºÎ∂Ä Í∑úÏ†ï');
                    }
                }

                // ‚îÄ‚îÄ ÏÑ†Í∏â (Íµ¨Ï°∞ Í∏∞Ï§ÄÏóê Îî∞Î•∏ ÏÑ†Í∏â Í∑úÏπô) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                // Double Hull: 5,000 DWT Ïù¥ÏÉÅ Ïú†Ï°∞ÏÑ† (MARPOL Annex I Reg.19)
                if (dwtNum >= 5000) {
                    r.ÏÑ†Í∏â.push('Double Hull ÏöîÍµ¨ÏÇ¨Ìï≠');
                }
                // CSR: 150m Ïù¥ÏÉÅ ÌÉ±Ïª§ (IACS Common Structural Rules)
                if (length >= 150) {
                    r.ÏÑ†Í∏â.push('CSR Í¥ÄÎ†®');
                }

                // ‚îÄ‚îÄ ÏïàÏ†ÑÎ≤ï (ÌïúÍµ≠ Íµ≠ÎÇ¥ Î≤ïÍ∑ú) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                // ÏÑ†Î∞ïÏïàÏ†ÑÎ≤ï: 24m Ïù¥ÏÉÅ ÏÑ†Î∞ï
                if (length >= 24) {
                    r.ÏïàÏ†ÑÎ≤ï.push('ÏÑ†Î∞ï ÏïàÏ†ÑÎ≤ï');
                }
                // Ïó∞Ïïà ÌÉ±Ïª§ Í∑úÏπô: Ïó∞Ìï¥¬∑ÌèâÏàò Íµ¨Ïó≠
                if (voyageArea === 'coastal' || voyageArea === 'freshwater') {
                    r.ÏïàÏ†ÑÎ≤ï.push('Ïó∞Ïïà ÌÉ±Ïª§ ÏïàÏ†Ñ Í∑úÏπô');
                }
            }

            // ‚îÄ‚îÄ Íµ≠Ï†ÅÎ≥Ñ ÌïÑÌÑ∞ÎßÅ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
            // ÏàúÏàòÏô∏Íµ≠Ï†Å: ÌïúÍµ≠ ÏïàÏ†ÑÎ≤ï ÎØ∏Ï†ÅÏö©
            if (nationality === 'foreign') {
                r.ÏïàÏ†ÑÎ≤ï = [];
            }
            // ÌïúÍµ≠Ï†Å: Íµ≠ÎÇ¥Ìï≠Ìï¥(Ïó∞Ìï¥¬∑ÌèâÏàò)Îäî ÌòëÏïΩ ÎØ∏Ï†ÅÏö©
            if (nationality === 'korean' && !isInternational) {
                r.ÌòëÏïΩ = [];
            }

            return r;
        }

        const descriptions = {
            'SOLAS Í∏∞Î≥∏ Í∑úÏ†ï': 'ÏÑ†Î∞ïÏùò ÏïàÏ†ÑÏùÑ ÏúÑÌïú Íµ≠Ï†ú ÌòëÏïΩÏùò Í∏∞Î≥∏ ÏöîÍµ¨ÏÇ¨Ìï≠',
            'SOLAS Ï†ÑÏ≤¥ Í∑úÏ†ï': 'ÏÑ†Î∞ïÏùò ÏïàÏ†ÑÏóê Í¥ÄÌïú Íµ≠Ï†ú ÌòëÏïΩ Ï†ÑÏ≤¥ Ï±ïÌÑ∞ Ï†ÅÏö©',
            'SOLAS Ï†ÑÏ≤¥': 'ÏÑ†Î∞ïÏùò ÏïàÏ†ÑÏóê Í¥ÄÌïú Íµ≠Ï†ú ÌòëÏïΩ Ï†ÑÏ≤¥ Ï±ïÌÑ∞ Ï†ÅÏö©',
            'SOLAS Í∑úÏ†ï': 'ÏÑ†Î∞ïÏùò ÏïàÏ†ÑÏóê Í¥ÄÌïú Íµ≠Ï†ú ÌòëÏïΩ',
            'MARPOL ÌòëÏïΩ': 'Ìï¥Ïñë Ïò§Ïóº Î∞©ÏßÄÎ•º ÏúÑÌïú Íµ≠Ï†ú ÌòëÏïΩ',
            'ISM Code': 'Íµ≠Ï†ú ÏïàÏ†ÑÍ¥ÄÎ¶¨ Í∑úÏπô - ÏÑ†Î∞ï Î∞è ÌöåÏÇ¨Ïùò ÏïàÏ†ÑÍ¥ÄÎ¶¨ Ï≤¥Í≥Ñ',
            'ISPS Code': 'Íµ≠Ï†ú ÏÑ†Î∞ï Î∞è Ìï≠ÎßåÏãúÏÑ§ Î≥¥Ïïà Í∑úÏπô',
            'IBC Code': 'ÏÇ∞Ï†Å ÌôîÌïôÏ†úÌíà Ïö¥ÏÜ°ÏÑ† Í∑úÏπô',
            'LSA Code': 'Íµ¨Î™ÖÏÑ§ÎπÑ Í∑úÏπô',
            'CSS Code': 'ÌôîÎ¨º Í≥†Î∞ï ÏïàÏ†Ñ Í∑úÏπô',
            'IMDG Code': 'Íµ≠Ï†ú Ìï¥ÏÉÅ ÏúÑÌóòÎ¨º Í∑úÏπô',
            'Safe Return to Port': 'Ïó¨Í∞ùÏÑ†Ïùò ÏïàÏ†ÑÌïú Í∑ÄÌï≠ ÏöîÍµ¨ÏÇ¨Ìï≠',
            'Torremolinos Protocol': 'Ïñ¥ÏÑ† ÏïàÏ†Ñ Íµ≠Ï†ú ÌòëÏïΩ',
            'RCD': 'Î†àÏ†ÄÏÑ†Î∞ï ÏßÄÏπ®',
            'LY3 Code': 'ÎåÄÌòï ÏöîÌä∏ Í∑úÏπô',
            'Double Hull ÏöîÍµ¨ÏÇ¨Ìï≠': 'Ïù¥Ï§ëÏÑ†Ï≤¥ Íµ¨Ï°∞ ÏöîÍµ¨ÏÇ¨Ìï≠',
            'ÏÑ†Î∞ï ÏïàÏ†ÑÎ≤ï': 'Íµ≠ÎÇ¥ ÏÑ†Î∞ï ÏïàÏ†ÑÏóê Í¥ÄÌïú Î≤ïÎ•†',
            'Ïó∞Ïïà ÌôîÎ¨ºÏÑ† ÏïàÏ†Ñ Í∑úÏπô': 'Ïó∞ÏïàÏùÑ Ìï≠Ìï¥ÌïòÎäî ÌôîÎ¨ºÏÑ†Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Ïó∞Ïïà ÌÉ±Ïª§ ÏïàÏ†Ñ Í∑úÏπô': 'Ïó∞ÏïàÏùÑ Ìï≠Ìï¥ÌïòÎäî ÌÉ±Ïª§Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Ïó∞Ïïà Ïó¨Í∞ùÏÑ† ÏïàÏ†Ñ Í∑úÏπô': 'Ïó∞ÏïàÏùÑ Ìï≠Ìï¥ÌïòÎäî Ïó¨Í∞ùÏÑ†Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'ÏõêÏñë Ïñ¥ÏÑ† ÏïàÏ†Ñ Í∑úÏπô': 'ÏõêÏñëÏùÑ Ìï≠Ìï¥ÌïòÎäî Ïñ¥ÏÑ†Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Ïó∞Ïïà Ïñ¥ÏÑ† ÏïàÏ†Ñ Í∑úÏπô': 'Ïó∞ÏïàÏùÑ Ìï≠Ìï¥ÌïòÎäî Ïñ¥ÏÑ†Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'ÏÜåÌòï ÏÑ†Î∞ï ÏïàÏ†Ñ Í∑úÏπô': 'ÏÜåÌòï ÏÑ†Î∞ïÏùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Î†àÏ†ÄÏÑ†Î∞ï ÏïàÏ†Ñ Í∑úÏπô': 'Î†àÏ†Ä Î™©Ï†Å ÏÑ†Î∞ïÏùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Íµ≠Ï†ú ÌôîÎ¨ºÏÑ† ÏïàÏ†Ñ ÏÑ§ÎπÑ Í∑úÏπô': 'ÌôîÎ¨ºÏÑ†Ïóê ÌïÑÏöîÌïú ÏïàÏ†Ñ ÏÑ§ÎπÑ Í∑úÏ†ï',
            'Ïó¨Í∞ùÏÑ† ÏïàÏ†Ñ Í∑úÏπô': 'Ïó¨Í∞ùÏÑ†Ïùò ÏïàÏ†Ñ Ïö¥Ìï≠ÏùÑ ÏúÑÌïú Í∑úÏπô',
            'Ïñ¥ÏÑ†Î≤ï': 'Ïñ¥ÏÑ†Ïùò Îì±Î°ù Î∞è Í¥ÄÎ¶¨Ïóê Í¥ÄÌïú Î≤ïÎ•†',
            'ÏÜåÌòï Ïñ¥ÏÑ† ÏïàÏ†Ñ Í∏∞Ï§Ä': '24ÎØ∏ÌÑ∞ ÎØ∏Îßå Ïñ¥ÏÑ†Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Íµ¨Î™ÖÏÑ§ÎπÑ Í∑úÏ†ï': 'ÏÑ†Î∞ï Íµ¨Î™ÖÏÑ§ÎπÑÏóê Í¥ÄÌïú Í∑úÏ†ï',
            'ISO ÏÜåÌòï ÏöîÌä∏ Í∏∞Ï§Ä': 'ISO Íµ≠Ï†ú ÌëúÏ§Ä ÏÜåÌòï ÏöîÌä∏ ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'MARPOL Annex I (Ïú†Î•òÏò§ÏóºÎ∞©ÏßÄ)': 'MARPOL Î∂ÄÏÜçÏÑú I - Ïú†Î•òÏóê ÏùòÌïú Ïò§Ïóº Î∞©ÏßÄ',
            'MARPOL Annex I': 'MARPOL Î∂ÄÏÜçÏÑú I - Ïú†Î•òÏóê ÏùòÌïú Ïò§Ïóº Î∞©ÏßÄ',
            'MARPOL Annex I, II': 'MARPOL Î∂ÄÏÜçÏÑú I(Ïú†Î•ò), II(ÏÇ∞Ï†Å Ïú†Ìï¥Ïï°Ï≤¥Î¨ºÏßà) Ïò§Ïóº Î∞©ÏßÄ',
            'MARPOL Ï†Ñ Î∂ÄÏÜçÏÑú': 'MARPOL ÌòëÏïΩ Î™®Îì† Î∂ÄÏÜçÏÑú(I-VI) Ï†ÅÏö©',
            'MARPOL ÏùºÎ∂Ä Ï†ÅÏö©': 'MARPOL ÌòëÏïΩ Ï§ë ÏùºÎ∂Ä Î∂ÄÏÜçÏÑú Ï†ÅÏö©',
            'ÎåÄÌòï Ïª®ÌÖåÏù¥ÎÑàÏÑ† ÏïàÏ†ïÏÑ± Í∑úÏ†ï': 'ÎåÄÌòï Ïª®ÌÖåÏù¥ÎÑàÏÑ†Ïùò Î≥µÏõêÏÑ± Î∞è ÏïàÏ†ïÏÑ± Í∞ïÌôî Í∑úÏ†ï',
            'SOLAS Chapter III (Íµ¨Î™ÖÏÑ§ÎπÑ)': 'SOLAS ÌòëÏïΩ Ï†ú3Ïû• - Íµ¨Î™ÖÏÑ§ÎπÑ Î∞è Ïû•Ïπò',
            'SOLAS Chapter III': 'SOLAS ÌòëÏïΩ Ï†ú3Ïû• - Íµ¨Î™ÖÏÑ§ÎπÑ Î∞è Ïû•Ïπò',
            'SOLAS ÏùºÎ∂Ä Í∑úÏ†ï': 'SOLAS ÌòëÏïΩ Ï§ë Ìï¥Îãπ ÏÑ†Î∞ïÏóê Ï†ÅÏö©ÎêòÎäî ÏùºÎ∂Ä Ï±ïÌÑ∞',
            'SOLAS ÏùºÎ∂Ä': 'SOLAS ÌòëÏïΩ Ï§ë Ìï¥Îãπ ÏÑ†Î∞ïÏóê Ï†ÅÏö©ÎêòÎäî ÏùºÎ∂Ä Ï±ïÌÑ∞',
            'SOLAS ÏùºÎ∂Ä (ÏûêÏú® Ï†ÅÏö©)': 'SOLAS ÌòëÏïΩ Ï§ë ÏûêÏú®Ï†ÅÏúºÎ°ú Ï†ÅÏö©Ìï† Ïàò ÏûàÎäî Î∂ÄÎ∂Ñ',
            'ISM Code (ÏûêÏú®)': 'Íµ≠Ï†ú ÏïàÏ†ÑÍ¥ÄÎ¶¨ Í∑úÏπô - ÏûêÏú® Ï†ÅÏö©',
            'ÏÜåÌòï ÏÑ†Î∞ï ÏïàÏ†Ñ Í∏∞Ï§Ä': 'ÏÜåÌòï ÏÑ†Î∞ïÏùò ÏïàÏ†Ñ Ïö¥Ìï≠ÏùÑ ÏúÑÌïú Í∏∞Ï§Ä',
            'Ïñ¥ÏÑ† ÏïàÏ†Ñ ÌòëÏïΩ': 'Ïñ¥ÏÑ†Ïùò ÏïàÏ†ÑÏóê Í¥ÄÌïú Íµ≠Ï†ú ÌòëÏïΩ',
            'IGC Code': 'Íµ≠Ï†ú Í∞ÄÏä§Ïö¥Î∞òÏÑ† Í∑úÏπô - Ïï°ÌôîÍ∞ÄÏä§ ÏÇ∞Ï†Å Ïö¥ÏÜ°ÏÑ† Íµ¨Ï°∞ Î∞è ÏÑ§ÎπÑ',
            'Ïó∞Ïïà Í∞ÄÏä§Ïö¥Î∞òÏÑ† ÏïàÏ†Ñ Í∑úÏπô': 'Ïó∞ÏïàÏùÑ Ìï≠Ìï¥ÌïòÎäî Í∞ÄÏä§Ïö¥Î∞òÏÑ†Ïùò ÏïàÏ†Ñ Í∏∞Ï§Ä',
            'Í∞ÄÏä§Ïö¥Î∞òÏÑ† ÌäπÎ≥Ñ ÏöîÍµ¨ÏÇ¨Ìï≠': 'Ïï°ÌôîÍ∞ÄÏä§ Ïö¥Î∞òÏÑ†Ïùò ÌôîÎ¨º Í≤©ÎÇ©, ÏïàÏ†ÑÏÑ§ÎπÑ ÌäπÎ≥Ñ ÏöîÍµ¨ÏÇ¨Ìï≠',

            'ICE Í¥ÄÎ†®': 'ÎπôÌï¥Ïö¥Ìï≠ÏÑ†Î∞ï ÏßÄÏπ® Ï†ú 2Ï†à',
            'Polar Code': 'Í∑πÏßÄ Ïö¥Ìï≠ ÏÑ†Î∞ïÏóê ÎåÄÌïú ÏïàÏ†Ñ Î∞è ÌôòÍ≤ΩÎ≥¥Ìò∏ Í∑úÏπô',

            'LI Í¥ÄÎ†®': 'UR L5Ïóê Îî∞Îùº TEST REPORT ÏäπÏù∏',

            'SPS Code': 'ÌäπÏàòÎ™©Ï†ÅÏÑ† ÏïàÏ†Ñ Í∑úÏπô (Special Purpose Ship Code)',
            'IP Code': 'ÏÇ∞ÏóÖÏù∏Î†• Ïö¥ÏÜ°ÏÑ†Î∞ï ÏïàÏ†Ñ Í∑úÏπô (Industrial Personnel Code)',
            'SFV Protocol': 'Ïñ¥ÏÑ† ÏïàÏ†ÑÏùÑ ÏúÑÌïú ÌÜ†Î†àÎ™∞Î¶¨ÎÖ∏Ïä§ ÏùòÏ†ïÏÑú (Torremolinos Protocol for Safety of Fishing Vessels)',
            'BLU Í¥ÄÎ†®': 'ÏßÄÏπ® 3Ìé∏ Î∂ÄÎ°ù 3-1',
            'LNG Ready': 'Ïï°ÌôîÏ≤úÏó∞Í∞ÄÏä§Ïó∞Î£å Ï§ÄÎπÑÏÑ†Î∞ï ÏßÄÏπ® 2Ïû•',
            'Ammonia Ready': 'ÏïîÎ™®ÎãàÏïÑ Ïó∞Î£åÏÑ†Î∞ïÏóê ÎåÄÌïú ÏßÄÏπ®ÏÑú Î∂ÄÎ°ù 1',
            'Methanol Ready': 'Ï†ÄÏù∏ÌôîÏ†êÏó∞Î£åÏÑ†Î∞ï Í∑úÏπô Ï†ÅÏö©ÏßÄÏπ® Î∂ÄÎ°ù 5',
            'Ethanol Ready': 'Ï†ÄÏù∏ÌôîÏ†êÏó∞Î£åÏÑ†Î∞ï Í∑úÏπô Ï†ÅÏö©ÏßÄÏπ® Î∂ÄÎ°ù 5',
            'ERS Í¥ÄÎ†®': 'Emergency Response Service Îì±Î°ù',
            'NBS Í¥ÄÎ†®': 'Í∑úÏπô 9Ìé∏ 5Ïû• Ï†ú 3Ï†à',
            'LIQBC Í¥ÄÎ†®': 'ÏßÄÏπ® 7Ìé∏ Î∂ÄÎ°ù 7-12 Í¥ëÏÑùÏÇ∞Ï†ÅÌôîÎ¨ºÏùò Ïï°ÏÉÅÌôî',
            'CSR Í¥ÄÎ†®': 'Common Structural Rules'
        };

        // ÏÑ†Í∏âÎ∂ÄÌò∏Ïóê Îî∞Î•∏ Ï∂îÍ∞Ä Í∑úÏπôÏùÑ Î∞òÌôòÌïòÎäî Ìï®Ïàò
        function getNotationRules(notations) {
            const additionalRules = [];

            if (notations.includes('ice')) {
                additionalRules.push('ICE Í¥ÄÎ†®');
            }
            if (notations.includes('LI')) {
                additionalRules.push('LI Í¥ÄÎ†®');
            }
            if (notations.includes('sps')) {
                additionalRules.push('SPS Code');
            }
            if (notations.includes('ip')) {
                additionalRules.push('IP Code');
            }
            if (notations.includes('sfv')) {
                additionalRules.push('SFV Protocol');
            }
            if (notations.includes('blu')) {
                additionalRules.push('BLU Í¥ÄÎ†®');
            }
            if (notations.includes('lngready')) {
                additionalRules.push('LNG Ready');
            }
            if (notations.includes('ammoniaready')) {
                additionalRules.push('Ammonia Ready');
            }
            if (notations.includes('methanolready')) {
                additionalRules.push('Methanol Ready');
            }
            if (notations.includes('ethanolready')) {
                additionalRules.push('Ethanol Ready');
            }
            if (notations.includes('ers')) {
                additionalRules.push('ERS Í¥ÄÎ†®');
            }
            if (notations.includes('nbs')) {
                additionalRules.push('NBS Í¥ÄÎ†®');
            }
            if (notations.includes('liqbc')) {
                additionalRules.push('LIQBC Í¥ÄÎ†®');
            }
            if (notations.includes('csr')) {
                additionalRules.push('CSR Í¥ÄÎ†®');
            }

            return additionalRules;
        }

        document.getElementById('shipForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // INPUT: Íµ≠Ï†Å, ÏÑ†Î∞ïÏùò Ï¢ÖÎ•ò, Ìï≠Ìï¥Íµ¨Ïó≠, Í∏∏Ïù¥, Ïû¨ÌôîÏ§ëÎüâ, ÌÜ§Ïàò
            const nationality = document.getElementById('nationality').value;
            const shipType = document.getElementById('shipType').value;
            const voyageArea = document.getElementById('voyageArea').value;
            const length = parseInt(document.getElementById('length').value);
            const dwt = document.getElementById('dwt').value;
            const gt = document.getElementById('gt').value;

            // ÏÑ†ÌÉùÎêú ÏÑ†Í∏âÎ∂ÄÌò∏ Í∞ÄÏ†∏Ïò§Í∏∞
            const checkboxes = document.querySelectorAll('input[name="notation"]:checked');
            const notations = Array.from(checkboxes).map(cb => cb.value);

            // Í∑úÏπô Ìï®Ïàò Ìò∏Ï∂ú (ÌòëÏïΩ/ÏÑ†Í∏â/ÏïàÏ†ÑÎ≤ï Î∂ÑÎ•ò)
            const categorizedRules = getRules(nationality, shipType, voyageArea, length, gt, dwt);

            // ÏÑ†Í∏âÎ∂ÄÌò∏Ïóê Îî∞Î•∏ Ï∂îÍ∞Ä Í∑úÏπô Í∞ÄÏ†∏Ïò§Í∏∞
            const notationRules = notations.length > 0 ? getNotationRules(notations) : [];

            // OUTPUT: Í≤∞Í≥º ÌëúÏãú
            displayResults(categorizedRules, notationRules, nationality, shipType, voyageArea, length, notations, dwt, gt);
        });

        function displayResults(categorizedRules, notationRules, nationality, shipType, voyageArea, length, notations = [], dwt = '', gt = '') {
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            const totalRules = categorizedRules.ÌòëÏïΩ.length + categorizedRules.ÏÑ†Í∏â.length + categorizedRules.ÏïàÏ†ÑÎ≤ï.length + notationRules.length;

            if (totalRules === 0) {
                resultContent.innerHTML = '<p style="color: #ef4444;">Ìï¥Îãπ Ï°∞Í±¥Ïóê ÎåÄÌïú Í∑úÏπô Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§.</p>';
            } else {
                let html = '<div style="margin-bottom: 20px;">';
                html += `<span class="badge">Íµ≠Ï†Å: ${getNationalityName(nationality)}</span>`;
                html += `<span class="badge">ÏÑ†Î∞ï Ï¢ÖÎ•ò: ${getShipTypeName(shipType)}</span>`;
                html += `<span class="badge">Ìï≠Ìï¥Íµ¨Ïó≠: ${getVoyageAreaName(voyageArea)}</span>`;
                html += `<span class="badge">Í∏∏Ïù¥: ${length}m</span>`;
                if (dwt) html += `<span class="badge">DWT: ${Number(dwt).toLocaleString()}ÌÜ§</span>`;
                if (gt) html += `<span class="badge">GT: ${Number(gt).toLocaleString()}ÌÜ§</span>`;

                // ÏÑ†Í∏âÎ∂ÄÌò∏ Î∞∞ÏßÄ ÌëúÏãú
                if (notations.length > 0) {
                    const notationNames = {
                        'ice': 'ICE', 'LI': 'LI', 'sps': 'SPS', 'ip': 'IP',
                        'sfv': 'SFV', 'blu': 'BLU', 'lngready': 'LNG Ready',
                        'ammoniaready': 'Ammonia Ready', 'methanolready': 'Methanol Ready',
                        'ethanolready': 'Ethanol Ready', 'ers': 'ERS', 'nbs': 'NBS',
                        'liqbc': 'LIQBC (1/2)', 'csr': 'CSR'
                    };
                    notations.forEach(n => {
                        html += `<span class="badge" style="background: #059669;">${notationNames[n]}</span>`;
                    });
                }
                html += '</div>';

                // ÏÑπÏÖò Î†åÎçîÎßÅ Ìó¨Ìçº
                function renderSection(title, icon, rules, borderColor, bgColor, titleColor) {
                    if (rules.length === 0) return '';
                    let s = `<h4 style="color: ${titleColor}; margin: 20px 0 10px; font-size: 16px; border-bottom: 2px solid ${borderColor}; padding-bottom: 8px;">${icon} ${title}</h4>`;
                    s += '<div class="result-grid">';
                    rules.forEach(rule => {
                        s += `<div class="result-item" style="border-left: 4px solid ${borderColor}; background: ${bgColor};">
                            <h4 style="color: ${titleColor};">‚úì ${rule}</h4>
                            <p>${descriptions[rule] || 'Í∑úÏπô ÏÑ§Î™ÖÏù¥ Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§.'}</p>
                        </div>`;
                    });
                    s += '</div>';
                    return s;
                }

                html += renderSection('ÌòëÏïΩ', 'üìú', categorizedRules.ÌòëÏïΩ, '#3b82f6', '#eff6ff', '#1e40af');
                html += renderSection('ÏÑ†Í∏â', 'üèóÔ∏è', categorizedRules.ÏÑ†Í∏â, '#7c3aed', '#faf5ff', '#6d28d9');
                html += renderSection('ÏïàÏ†ÑÎ≤ï', '‚öñÔ∏è', categorizedRules.ÏïàÏ†ÑÎ≤ï, '#d97706', '#fffbeb', '#b45309');
                html += renderSection('ÏÑ†Í∏âÎ∂ÄÌò∏', '‚öì', notationRules, '#10b981', '#f0fdf4', '#059669');

                resultContent.innerHTML = html;
            }

            resultDiv.classList.add('show');

            // PDF Îã§Ïö¥Î°úÎìú Î≤ÑÌäº ÌëúÏãú
            const pdfBtn = document.getElementById('pdfBtn');
            if (totalRules > 0) {
                pdfBtn.classList.add('show');
            } else {
                pdfBtn.classList.remove('show');
            }
        }

        function downloadPDF() {
            // Î∏åÎùºÏö∞Ï†Ä ÎÑ§Ïù¥Ìã∞Î∏å PDF Ï∂úÎ†• ÏÇ¨Ïö© (ÏµúÍ≥† ÌôîÏßà)
            window.print();
        }

        function getShipTypeName(type) {
            const names = {
                oilchemicaltanker: 'OIL/CHEMICAL TANKER'
            };
            return names[type] || type;
        }

        function getVoyageAreaName(area) {
            const names = {
                ocean: 'ÏõêÏñë',
                greatcoastal: 'Í∑ºÌï¥',
                coastal: 'Ïó∞Ìï¥',
                freshwater: 'ÌèâÏàò'
            };
            return names[area] || area;
        }

        function getNationalityName(nationality) {
            const names = {
                korean: 'ÌïúÍµ≠Ï†Å (BBCHP)',
                foreign: 'ÏàúÏàòÏô∏Íµ≠Ï†Å'
            };
            return names[nationality] || nationality;
        }

        // ===== Cubic Spline Î≥¥Í∞Ñ Í≥ÑÏÇ∞Í∏∞ =====

        // Cubic Spline ÌÅ¥ÎûòÏä§
        class CubicSpline {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.n = x.length;
                this.calculateCoefficients();
            }

            calculateCoefficients() {
                const n = this.n - 1;
                const h = [];
                const alpha = [];

                // Calculate h and alpha
                for (let i = 0; i < n; i++) {
                    h[i] = this.x[i + 1] - this.x[i];
                }

                for (let i = 1; i < n; i++) {
                    alpha[i] = (3 / h[i]) * (this.y[i + 1] - this.y[i]) -
                               (3 / h[i - 1]) * (this.y[i] - this.y[i - 1]);
                }

                // Solve tridiagonal system
                const l = [1];
                const mu = [0];
                const z = [0];

                for (let i = 1; i < n; i++) {
                    l[i] = 2 * (this.x[i + 1] - this.x[i - 1]) - h[i - 1] * mu[i - 1];
                    mu[i] = h[i] / l[i];
                    z[i] = (alpha[i] - h[i - 1] * z[i - 1]) / l[i];
                }

                l[n] = 1;
                z[n] = 0;

                this.c = new Array(this.n).fill(0);
                this.b = new Array(n);
                this.d = new Array(n);

                for (let j = n - 1; j >= 0; j--) {
                    this.c[j] = z[j] - mu[j] * this.c[j + 1];
                    this.b[j] = (this.y[j + 1] - this.y[j]) / h[j] -
                                h[j] * (this.c[j + 1] + 2 * this.c[j]) / 3;
                    this.d[j] = (this.c[j + 1] - this.c[j]) / (3 * h[j]);
                }
            }

            interpolate(xi) {
                // Find the right interval
                let i = 0;
                for (i = 0; i < this.n - 1; i++) {
                    if (xi <= this.x[i + 1]) break;
                }

                if (i >= this.n - 1) i = this.n - 2;

                const dx = xi - this.x[i];
                return this.y[i] +
                       this.b[i] * dx +
                       this.c[i] * dx * dx +
                       this.d[i] * dx * dx * dx;
            }
        }

        let interpolationChart = null;

        function calculateInterpolation() {
            try {
                // Parse input values
                const xInput = document.getElementById('xValues').value;
                const yInput = document.getElementById('yValues').value;
                const interpolateX = parseFloat(document.getElementById('interpolateX').value);

                const xValues = xInput.split(',').map(v => parseFloat(v.trim()));
                const yValues = yInput.split(',').map(v => parseFloat(v.trim()));

                // Validate inputs
                if (xValues.length !== yValues.length) {
                    alert('X Í∞íÍ≥º Y Í∞íÏùò Í∞úÏàòÍ∞Ä Í∞ôÏïÑÏïº Ìï©ÎãàÎã§.');
                    return;
                }

                if (xValues.length < 3) {
                    alert('ÏµúÏÜå 3Í∞ú Ïù¥ÏÉÅÏùò Îç∞Ïù¥ÌÑ∞ Ìè¨Ïù∏Ìä∏Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.');
                    return;
                }

                if (xValues.some(isNaN) || yValues.some(isNaN) || isNaN(interpolateX)) {
                    alert('Ïò¨Î∞îÎ•∏ Ïà´ÏûêÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }

                // Create cubic spline
                const spline = new CubicSpline(xValues, yValues);

                // Calculate interpolated value
                const interpolatedY = spline.interpolate(interpolateX);

                // Display result
                document.getElementById('resultText').textContent =
                    `X = ${interpolateX}ÏóêÏÑú Î≥¥Í∞ÑÎêú Í∞í: Y = ${interpolatedY.toFixed(4)}`;
                document.getElementById('interpolationResult').style.display = 'block';

                // Generate curve data
                const minX = Math.min(...xValues);
                const maxX = Math.max(...xValues);
                const curveX = [];
                const curveY = [];
                const step = (maxX - minX) / 1000;

                for (let x = minX; x <= maxX; x += step) {
                    curveX.push(x);
                    curveY.push(spline.interpolate(x));
                }

                // Draw chart
                drawInterpolationChart(xValues, yValues, curveX, curveY, interpolateX, interpolatedY);

            } catch (error) {
                alert('Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + error.message);
                console.error(error);
            }
        }

        function drawInterpolationChart(xValues, yValues, curveX, curveY, findX, findY) {
            const ctx = document.getElementById('interpolationChart').getContext('2d');

            if (interpolationChart) {
                interpolationChart.destroy();
            }

            interpolationChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Interpolation',
                            data: curveX.map((x, i) => ({x: x, y: curveY[i]})),
                            borderColor: 'rgba(0, 0, 0, 1)',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            pointRadius: 0,
                            showLine: true,
                            tension: 0,
                            type: 'line'
                        },
                        {
                            label: 'Given value',
                            data: xValues.map((x, i) => ({x: x, y: yValues[i]})),
                            borderColor: 'rgba(30, 58, 138, 1)',
                            backgroundColor: 'rgba(30, 58, 138, 1)',
                            pointRadius: 8,
                            pointStyle: 'circle',
                            pointBorderWidth: 2,
                            pointBorderColor: 'rgba(30, 58, 138, 1)'
                        },
                        {
                            label: 'Find value',
                            data: [{x: findX, y: findY}],
                            borderColor: 'rgba(239, 68, 68, 1)',
                            backgroundColor: 'rgba(239, 68, 68, 1)',
                            pointRadius: 15,
                            pointStyle: 'rectRot',
                            pointBorderWidth: 3,
                            pointBorderColor: 'rgba(239, 68, 68, 1)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Interpolation & Find value',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `X: ${context.parsed.x.toFixed(3)}, Y: ${context.parsed.y.toFixed(4)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: 'X'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Y'
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
